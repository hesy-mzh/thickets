\documentclass[12pt,b5paper]{ltjsarticle}

%\usepackage[margin=15truemm, top=5truemm, bottom=5truemm]{geometry}
%\usepackage[margin=10truemm,left=15truemm]{geometry}
\usepackage[margin=10truemm]{geometry}

\usepackage{amsmath,amssymb}
%\pagestyle{headings}
\pagestyle{empty}

%\usepackage{listings,url}
%\renewcommand{\theenumi}{(\arabic{enumi})}

%\usepackage{graphicx}

%\usepackage{tikz}
%\usetikzlibrary {arrows.meta}
%\usepackage{wrapfig}
%\usepackage{bm}

% ルビを振る
\usepackage{luatexja-ruby}	% required for `\ruby'

%% 核Ker 像Im Hom を定義
%\newcommand{\Img}{\mathop{\mathrm{Im}}\nolimits}
%\newcommand{\Ker}{\mathop{\mathrm{Ker}}\nolimits}
%\newcommand{\Hom}{\mathop{\mathrm{Hom}}\nolimits}

%\DeclareMathOperator{\Rot}{rot}
%\DeclareMathOperator{\Div}{div}
%\DeclareMathOperator{\Grad}{grad}
%\DeclareMathOperator{\arcsinh}{arcsinh}
%\DeclareMathOperator{\arccosh}{arccosh}
%\DeclareMathOperator{\arctanh}{arctanh}

\usepackage{url}

%\usepackage{listings}
%
%\lstset{
%%プログラム言語(複数の言語に対応，C,C++も可)
%  language = Python,
%%  language = Lisp,
%%  language = C,
%  %背景色と透過度
%  %backgroundcolor={\color[gray]{.90}},
%  %枠外に行った時の自動改行
%  breaklines = true,
%  %自動改行後のインデント量(デフォルトでは20[pt])
%  breakindent = 10pt,
%  %標準の書体
%%  basicstyle = \ttfamily\scriptsize,
%  basicstyle = \ttfamily,
%  %コメントの書体
%%  commentstyle = {\itshape \color[cmyk]{1,0.4,1,0}},
%  %関数名等の色の設定
%  classoffset = 0,
%  %キーワード(int, ifなど)の書体
%%  keywordstyle = {\bfseries \color[cmyk]{0,1,0,0}},
%  %表示する文字の書体
%  %stringstyle = {\ttfamily \color[rgb]{0,0,1}},
%  %枠 "t"は上に線を記載, "T"は上に二重線を記載
%  %他オプション：leftline，topline，bottomline，lines，single，shadowbox
%  frame = TBrl,
%  %frameまでの間隔(行番号とプログラムの間)
%  framesep = 5pt,
%  %行番号の位置
%  numbers = left,
%  %行番号の間隔
%  stepnumber = 1,
%  %行番号の書体
%%  numberstyle = \tiny,
%  %タブの大きさ
%  tabsize = 4,
%  %キャプションの場所("tb"ならば上下両方に記載)
%  captionpos = t
%}

%\usepackage{cancel}
%\usepackage{bussproofs}
%\usepackage{proof}

\begin{document}

\hrulefill

\begin{enumerate}
 \item
      \begin{enumerate}
       \item
            $N$個の格子からなる自由境界条件の
            1次元Ising模型の分配関数$Z^{(\mathrm{open})}_{N}$を求めよ。
            \begin{equation}
             Z^{(\mathrm{open})}_{N}
              = \sum_{\sigma_{0},\sigma_{1},\dots,\sigma_{N-1} = \pm 1}
              \exp \left[
                    K \sum_{j=0}^{N-2}\sigma_{j}\sigma_{j+1}
                    \right]
            \end{equation}

            \dotfill

            各$j$に対して$\sigma_{j}=\pm 1$であるので、
            積$\sigma_{j}\sigma_{j+1}$は次の4つがある。
            \begin{equation}
             \sigma_{j}\sigma_{j+1} =
             \begin{cases}
              1 & (\sigma_{j},\sigma_{j+1})=(1,1)\\
              -1 & (\sigma_{j},\sigma_{j+1})=(1,-1)\\
              -1 & (\sigma_{j},\sigma_{j+1})=(-1,1)\\
              1 & (\sigma_{j},\sigma_{j+1})=(-1,-1)
             \end{cases}
            \end{equation}

            2個の格子($N=2$)で考えてみると
            次のような結果が得られる。
            \begin{align}
             Z^{(\mathrm{open})}_{2}
              &= \sum_{\sigma_{0},\sigma_{1} = \pm 1}
              \exp \left[
                    K \sum_{j=0}^{2-2}\sigma_{j}\sigma_{j+1}
                    \right]\\
              &= \sum_{\sigma_{0},\sigma_{1} = \pm 1}
              \exp \left[
                    K \sigma_{0}\sigma_{1}
                    \right]\\
             &= \exp\left[ K \right] + \exp\left[ -K \right]
             + \exp\left[ -K \right] + \exp\left[ K \right]\\
             &= 2\left( \exp\left[ K \right] + \exp\left[ -K \right] \right)\label{eq_r2}
            \end{align}


%            $\sum_{j=0}^{N-2}\sigma_{j}\sigma_{j+1}$を評価する。
%
%            
%
%
%            \begin{equation}
%             \sigma_{0}\sigma_{1} + \sigma_{1}\sigma_{2} =
%             \begin{cases}
%              2 & (\sigma_{0},\sigma_{1},\sigma_{2})=(1,1,1)\\
%              0 & (\sigma_{0},\sigma_{1},\sigma_{2})=(1,1,-1)\\
%              -2 & (\sigma_{0},\sigma_{1},\sigma_{2})=(1,-1,1)\\
%              0 & (\sigma_{0},\sigma_{1},\sigma_{2})=(1,-1,-1)\\
%              0 & (\sigma_{0},\sigma_{1},\sigma_{2})=(-1,1,1)\\
%              -2 & (\sigma_{0},\sigma_{1},\sigma_{2})=(-1,1,-1)\\
%              0 & (\sigma_{0},\sigma_{1},\sigma_{2})=(-1,-1,1)\\
%              2 & (\sigma_{0},\sigma_{1},\sigma_{2})=(-1,-1,-1)\\
%             \end{cases}
%            \end{equation}
%
%            \begin{equation}
%             Z^{(\mathrm{open})}_{3}
%              = 2\left( \exp\left[ 2K \right] + 2
%              + \exp\left[ -2K \right] \right)
%              = 2 \left( \exp\left[ K \right] + \exp\left[ -K \right]\right)^{2}
%            \end{equation}
%
%
%            \begin{equation}
%             \sigma_{0}\sigma_{1} + \sigma_{1}\sigma_{2}
%              + \sigma_{1}\sigma_{2} =
%             \begin{cases}
%              3 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(1,1,1,1)\\
%              1 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(1,1,1,-1)\\
%              -1 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(1,1,-1,1)\\
%              1 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(1,1,-1,-1)\\
%              -1 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(1,-1,1,1)\\
%              -3 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(1,-1,1,-1)\\
%              -1 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(1,-1,-1,1)\\
%              1 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(1,-1,-1,-1)\\
%%
%              1 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(-1,1,1,1)\\
%              -1 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(-1,1,1,-1)\\
%              -3 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(-1,1,-1,1)\\
%              -1 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(-1,1,-1,-1)\\
%              1 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(-1,-1,1,1)\\
%              -1 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(-1,-1,1,-1)\\
%              1 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(-1,-1,-1,1)\\
%              3 & (\sigma_{0},\sigma_{1},\sigma_{2},\sigma_{3})=(-1,-1,-1,-1)\\
%             \end{cases}
%            \end{equation}
%
%            \begin{align}
%             Z^{(\mathrm{open})}_{4}
%              &= 2\left( \exp\left[ 3K \right] + 3\exp\left[ K \right]
%              + 3\exp\left[ -K \right] + \exp\left[ -3K \right] \right)\\
%              &= 2 \left( \exp\left[ K \right] + \exp\left[ -K \right] \right)^{3}
%            \end{align}
%
%            $Z^{(\mathrm{open})}_{N}$は次のような式でないかと予想される。
%            \begin{equation}
%             Z^{(\mathrm{open})}_{N}
%              = 2 \left(
%                   \exp\left[ K \right] + \exp\left[ -K \right]
%                  \right)^{N-1}
%            \end{equation}
%
%
%            数学的帰納法を用いて考える。
%            
%            \eqref{eq_r2}より$N=2$の時は成立する。
%            
%            $N=n$のとき成り立つと仮定し$N=n+1$について考える。
%            \begin{align}
%             Z^{(\mathrm{open})}_{n+1}
%              &= \sum_{\sigma_{0},\sigma_{1},\dots,\sigma_{n} = \pm 1}
%                \exp \left[
%                    K \sum_{j=0}^{n-1}\sigma_{j}\sigma_{j+1}
%                    \right]\\
%              &= \sum_{\sigma_{0},\sigma_{1},\dots,\sigma_{n} = \pm 1}
%                \exp \left[
%                    K \sum_{j=0}^{n-2}\sigma_{j}\sigma_{j+1}
%                    \right]
%                \exp \left[
%                    K \sigma_{n-1}\sigma_{n}
%                    \right]\\
%              &= \sum_{\sigma_{0},\sigma_{1},\dots,\sigma_{n-1} = \pm 1}
%                \exp \left[
%                    K \sum_{j=0}^{n-2}\sigma_{j}\sigma_{j+1}
%                    \right]
%             \left(
%                \exp \left[K \sigma_{n-1} \right]+\exp \left[-K \sigma_{n-1} \right]
%             \right)\\
%            \end{align}



            \begin{align}
             Z^{(\mathrm{open})}_{N}
              &= \sum_{\sigma_{0},\dots,\sigma_{N-1} = \pm 1}
                \exp \left[
                    K \sum_{j=0}^{N-2}\sigma_{j}\sigma_{j+1}
                    \right]\\
              &= \sum_{\sigma_{0},\dots,\sigma_{N-1} = \pm 1}
                \exp \left[
                    K \sum_{j=0}^{N-3}\sigma_{j}\sigma_{j+1}
                    \right]
                \exp \left[
                    K \sigma_{N-2}\sigma_{N-1}
                    \right]\\
              &= \sum_{\sigma_{0},\dots,\sigma_{N-2} = \pm 1}
                \exp \left[
                    K \sum_{j=0}^{N-3}\sigma_{j}\sigma_{j+1}
                    \right] \left(
                      \exp \left[K \sigma_{N-2} \right]
                        +\exp \left[-K \sigma_{N-2} \right]
                    \right)\\
              &= \sum_{\sigma_{0},\dots,\sigma_{N-2} = \pm 1}
                \exp \left[
                    K \sum_{j=0}^{N-4}\sigma_{j}\sigma_{j+1}
                    \right] \nonumber\\
                & \qquad\qquad \exp \left[
                    K \sigma_{N-3}\sigma_{N-2}
                    \right]
                    \left(
                      \exp \left[K \sigma_{N-2} \right]
                        +\exp \left[-K \sigma_{N-2} \right]
                    \right)\\
              &= (\exp [K]+\exp [-K])
                \sum_{\sigma_{0},\dots,\sigma_{N-3} = \pm 1}
                \exp \left[
                    K \sum_{j=0}^{N-4}\sigma_{j}\sigma_{j+1}
                    \right]\nonumber\\
                & \qquad\qquad\qquad\qquad\qquad\qquad
                  \left(
                      \exp \left[K \sigma_{N-3} \right]
                        +\exp \left[-K \sigma_{N-3} \right]
                    \right)\\
             & \vdots \nonumber\\
              &= (\exp [K]+\exp [-K])^{N-3}
                \sum_{\sigma_{0},\sigma_{1} = \pm 1}
                \exp \left[
                    K \sum_{j=0}^{0}\sigma_{j}\sigma_{j+1}
                    \right]\nonumber\\
                & \qquad\qquad\qquad\qquad\qquad\qquad
                  \left(
                      \exp \left[K \sigma_{1} \right]
                        +\exp \left[-K \sigma_{1} \right]
                    \right)\\
             & = 2 (\exp [K]+\exp [-K])^{N-1}
            \end{align}

            $\sum$の末尾より一つずつ分けて$\sigma_{j}=\pm 1$を代入していくと、
            式\eqref{eq_r2}より上記結果が得られる。

            \begin{equation}
             Z^{(\mathrm{open})}_{N} = 2 (\exp [K]+\exp [-K])^{N-1}
              \label{eq_zn}
            \end{equation}

            \hrulefill


       \item
            遷移行列$T$の$N$乗の行列$T^{N}$を求めよ。
            \begin{equation}
             T=
              \begin{pmatrix}
               e^{K} & e^{-K} \\ e^{-K} & e^{K}
              \end{pmatrix}
              =
              e^{-K}
              \begin{pmatrix}
               a & 1 \\ 1 & a
              \end{pmatrix}
              ,\qquad
              a=e^{2K}
            \end{equation}

            $T^{N}$の行列要素を次のように置いたときの
            $A_{N}$と$B_{N}$の漸化式を考えて$T^{N}$を求める。
            \begin{equation}
             T^{N} =
              e^{-NK}
              \begin{pmatrix}
               A_{N} & B_{N} \\ B_{N} & A_{N}
              \end{pmatrix}
            \end{equation}

            \dotfill


            $T^{N}$の計算をする。
            \begin{align}
             T^{N}
             &= e^{-NK}
             \begin{pmatrix}
              a & 1 \\ 1 & a
             \end{pmatrix}
             \begin{pmatrix}
              a & 1 \\ 1 & a
             \end{pmatrix}^{\!\!N-1}
             = e^{-NK}
             \begin{pmatrix}
     %        A_{1} & B_{1} \\ B_{1} & A_{1}
              a & 1 \\ 1 & a
             \end{pmatrix}
             \begin{pmatrix}
              A_{N-1} & B_{N-1} \\ B_{N-1} & A_{N-1}
             \end{pmatrix}\\
             &= e^{-NK}
             \begin{pmatrix}
              aA_{N-1}+B_{N-1} & A_{N-1}+aB_{N-1} \\
              A_{N-1}+aB_{N-1} & aA_{N-1}+B_{N-1}
             \end{pmatrix}
            \end{align}

            $A_{N}$と$B_{N}$の漸化式は次のようになる。
            \begin{gather}
             A_{1}=a ,\quad
%        A_{2} = a^{2}+1 ,\quad
             A_{N} = aA_{N-1}+B_{N-1} \label{eq_A} \\
%        ,\quad
             B_{1}=1 ,\quad
%        B_{2}=2a ,\quad
             B_{N} = A_{N-1}+aB_{N-1} \label{eq_B}
            \end{gather}

      $A_{N}+\alpha B_{N} = \beta (A_{N-1}+\alpha B_{N-1})$
      を満たす$(\alpha,\beta)$を見つける為に、
      この左辺に\eqref{eq_A}、\eqref{eq_B}を代入し計算する。
      \begin{gather}
       aA_{N-1}+B_{N-1} +\alpha (A_{N-1}+aB_{N-1})
        = \beta (A_{N-1}+\alpha B_{N-1})\\
       a + \alpha = \beta ,\quad 1+a\alpha = \alpha\beta\\
       (\alpha,\beta) = (1,a+1),\;(-1,a-1)
      \end{gather}

      これにより次の式が得られる。
      \begin{equation}
       \begin{cases}
        A_{N}+ B_{N} = (a+1) (A_{N-1}+ B_{N-1})\\
        A_{N}- B_{N} = (a-1) \left( A_{N-1}- B_{N-1} \right)
       \end{cases}
      \end{equation}

      数列$\{A_{N} \pm B_{N}\}$の一般項が次のように求まる。
      \begin{equation}
       \begin{cases}
        A_{N}+ B_{N} = (a+1)^{N} \\
        A_{N}- B_{N} = (a-1)^{N}
       \end{cases}
      \end{equation}
      
      よって、この式の和と差から次が得られる。
      \begin{equation}
       A_{N} = \frac{1}{2}\left( (a+1)^{N} + (a-1)^{N} \right)
        ,\quad
       B_{N} = \frac{1}{2}\left( (a+1)^{N} - (a-1)^{N} \right)
      \end{equation}

      これにより$T^{N}$が次のように求まる。
      \begin{equation}
       T^{N} =
        \frac{e^{-NK}}{2}
        \begin{pmatrix}
         (a+1)^{N} + (a-1)^{N} & (a+1)^{N} - (a-1)^{N} \\
         (a+1)^{N} - (a-1)^{N} & (a+1)^{N} + (a-1)^{N}
        \end{pmatrix}
        \label{eq_tn}
      \end{equation}

      \hrulefill

       \item

            $T^{N}$
            と
            $Z^{(\mathrm{open})}_{N}$
            はどのように関係しているか?

            \dotfill

            式\eqref{eq_zn}より
            \begin{align}
             Z^{(\mathrm{open})}_{N}
              &= 2 (e^{K} + e^{-K})^{N-1}\\
              &= 2 e^{-(N-1)K} (a + 1)^{N-1}
            \end{align}

            式\eqref{eq_tn}より
            \begin{align}
             T^{N-1} &=
              \frac{e^{-(N-1)K}}{2}
              \begin{pmatrix}
               (a+1)^{N-1} + (a-1)^{N-1} & (a+1)^{N-1} - (a-1)^{N-1} \\
               (a+1)^{N-1} - (a-1)^{N-1} & (a+1)^{N-1} + (a-1)^{N-1}
              \end{pmatrix}\\
             &=
              \frac{1}{4}Z^{(\mathrm{open})}_{N}
              \begin{pmatrix} 1 & 1 \\ 1 & 1 \end{pmatrix}
             +
              \frac{(a-1)^{N-1}}{4(a+1)^{N-1}}Z^{(\mathrm{open})}_{N}
              \begin{pmatrix}
               1 & -1 \\
               -1 & 1
              \end{pmatrix}
            \end{align}



             \hrulefill
      \end{enumerate}

 \item
      $N$個の1次元格子の各点上の変数$\sigma_{j} \; (j=0,1,2,\dots,N-1)$
      がそれぞれ$\sigma_{j} \in \{0,1,2\}$の3つの値をとり、
      隣り合う格子点$\sigma_{j}$と$\sigma_{j+1}$の値によって
      その起こり得る相対確率 (Boltzmann重率)が
      \begin{equation}
       \exp \left[ K(2\delta_{\sigma_{j},\sigma_{j+1}}-1) \right],
        \qquad
        \delta_{a,b} = \begin{cases}
                        1 & (a = b)\\ 0 & (a\ne b)
                       \end{cases}
      \end{equation}
      であるような模型を考える。
      この模型の周期境界条件$(\sigma_{N} = \sigma_{0})$
      のもとでの分配関数$Z^{(\mathrm{close})}_{N}$を求めよ。
      \begin{equation}
       Z^{(\mathrm{close})}_{N} =
        \sum_{\sigma_{0},\sigma_{1},\dots,\sigma_{N-1} = 0,1,2}
        \exp \left[
              K \sum_{j=0}^{N-1} (2\delta_{\sigma_{j},\sigma_{j+1}}-1)
             \right]
      \end{equation}

      \dotfill

      $2\delta_{\sigma_{j},\sigma_{j+1}}-1$は次の9パターンの値がある。
      \begin{equation}
       2\delta_{\sigma_{j},\sigma_{j+1}}-1
        =
        \begin{cases}
         1 & (\sigma_{j},\sigma_{j+1})=(0,0)\\
         -1 & (\sigma_{j},\sigma_{j+1})=(0,1)\\
         -1 & (\sigma_{j},\sigma_{j+1})=(0,2)\\
         -1 & (\sigma_{j},\sigma_{j+1})=(1,0)\\
         1 & (\sigma_{j},\sigma_{j+1})=(1,1)\\
         -1 & (\sigma_{j},\sigma_{j+1})=(1,2)\\
         -1 & (\sigma_{j},\sigma_{j+1})=(2,0)\\
         -1 & (\sigma_{j},\sigma_{j+1})=(2,1)\\
         1 & (\sigma_{j},\sigma_{j+1})=(2,2)
        \end{cases}
      \end{equation}

      $N=2$の場合、$Z^{(\mathrm{close})}_{2}$を計算する。
      \begin{align}
       Z^{(\mathrm{close})}_{2}
        &= \sum_{\sigma_{0},\sigma_{1} = 0,1,2}
        \exp \left[
              K \sum_{j=0}^{2-1} (2\delta_{\sigma_{j},\sigma_{j+1}}-1)
             \right]\\
        &= \sum_{\sigma_{0},\sigma_{1} = 0,1,2}
        \exp \left[
              K (2\delta_{\sigma_{0},\sigma_{1}}-1)
             \right]
        \exp \left[
              K (2\delta_{\sigma_{1},\sigma_{2}}-1)
             \right]\\
        &= \sum_{\sigma_{0},\sigma_{1} = 0,1,2}
        \exp \left[
              2K (2\delta_{\sigma_{0},\sigma_{1}}-1)
             \right]\\
        &= 
        3\exp \left[ 2K \right]
        + 6\exp \left[ -2K \right]
      \end{align}

      \begin{align}
       Z^{(\mathrm{close})}_{N} &=
        \sum_{\sigma_{0},\sigma_{1},\dots,\sigma_{N-1} = 0,1,2}
        \exp \left[
              K \sum_{j=0}^{N-1} (2\delta_{\sigma_{j},\sigma_{j+1}}-1)
             \right]\\
       &= \sum_{\sigma_{0},\sigma_{1},\dots,\sigma_{N-1} = 0,1,2}
             \exp \left[
              K \sum_{j=0}^{N-3} (2\delta_{\sigma_{j},\sigma_{j+1}}-1)
             \right]\nonumber\\
           &\qquad\qquad  \exp \left[
              K (2\delta_{\sigma_{N-2},\sigma_{N-1}}-1)
             \right]
             \exp \left[
              K (2\delta_{\sigma_{N-1},\sigma_{N}}-1)
             \right]\\
      \end{align}








      \hrulefill

\end{enumerate}

\hrulefill

\end{document}
